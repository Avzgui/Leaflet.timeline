!function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";L.TimelineVersion="1.0.0",i(1),i(3),i(4)},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}var r=function(){function t(t,e){var i=[],n=!0,r=!1,s=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done)&&(i.push(a.value),!e||i.length!==e);n=!0);}catch(u){r=!0,s=u}finally{try{!n&&o["return"]&&o["return"]()}finally{if(r)throw s}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=i(2),a=n(s);L.Timeline=L.GeoJSON.extend({includes:L.Mixin.Events,times:[],displayedLayers:[],ranges:[],options:{position:"bottomleft",formatDate:function(){return""},enablePlayback:!0,enableKeyboardControls:!1,steps:1e3,duration:1e3,showTicks:!0,waitToUpdateMap:!1},initialize:function(t,e){this.times=[],L.GeoJSON.prototype.initialize.call(this,null,e),L.extend(this.options,e),this.ranges=new a["default"],e.intervalFromFeature&&(this._intervalFromFeature=e.intervalFromFeature.bind(this)),e.addData&&(this.addData=e.addData.bind(this)),e.doSetTime&&(this.doSetTime=e.doSetTime.bind(this)),t&&this._process(t)},_intervalFromFeature:function(t){return{start:new Date(t.properties.start).getTime(),end:new Date(t.properties.end).getTime()}},_process:function(t){var e=this,i=1/0,n=-(1/0);t.features.forEach(function(t){var r=e._intervalFromFeature(t);e.ranges.insert(r.start,r.end,t),e.times.push(r.start),e.times.push(r.end),i=Math.min(i,r.start),n=Math.max(n,r.end)}),this.options.start=this.options.start||i,this.options.end=this.options.end||n,this.times=this.times.sort(function(t,e){return t-e}).reduce(function(t,e){return t[t.length-1]!==e&&t.push(e),t},[])},addData:function(t){var e=L.Util.isArray(t)?t:t.features;e?e.filter(function(t){return t.geometries||t.geometry||t.features||t.coordinates}).forEach(this.addData.bind(this)):this._addData(t)},_addData:function(t){if(!this.options.filter||this.options.filter(t)){var e=/^(\d+)(\.(\d+))?(\.(\d+))?(-(.*))?(\+(.*))?$/,i=e.exec(L.version),n=r(i,4),s=n[1],a=n[3],o=L.GeoJSON.geometryToLayer(t,0===parseInt(s,10)&&parseInt(a,10)<=7?this.options.pointToLayer:this.options);this.displayedLayers.push({layer:o,geoJSON:t}),o.feature=L.GeoJSON.asFeature(t),o.defaultOptions=o.options,this.resetStyle(o),this.options.onEachFeature&&this.options.onEachFeature(t,o),this.addLayer(o)}},removeLayer:function(t){var e=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];L.GeoJSON.prototype.removeLayer.call(this,t),e&&(this.displayedLayers=this.displayedLayers.filter(function(e){return e.layer!==t}))},setTime:function(t){this.time=new Date(t).getTime(),this.doSetTime(t),this.fire("change")},doSetTime:function(t){var e=this.ranges.lookup(t),i=void 0,n=void 0,r=void 0;for(i=0;i<this.displayedLayers.length;i++){for(r=!1,n=0;n<e.length;n++)if(this.displayedLayers[i].geoJSON===e[n]){r=!0,e.splice(n,1);break}if(!r){var s=this.displayedLayers.splice(i--,1);this.removeLayer(s[0].layer,!1)}}e.forEach(this.addData.bind(this))},onAdd:function(t){L.GeoJSON.prototype.onAdd.call(this,t),this.timeSliderControl=L.Timeline.timeSliderControl(this),this.timeSliderControl.addTo(t)},onRemove:function(t){L.GeoJSON.prototype.onRemove.call(this,t),this.timeSliderControl.removeFrom(t)},getDisplayed:function(){return this.ranges.lookup(this.time)}}),L.timeline=function(){for(var t=arguments.length,e=Array(t),i=0;t>i;i++)e[i]=arguments[i];return new(Function.prototype.bind.apply(L.Timeline,[null].concat(e)))}},function(t,e){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();Object.defineProperty(e,"__esModule",{value:!0});var s=function o(t,e,i,r){n(this,o),this.low=t,this.high=e,this.max=e,this.data=i,this.left=null,this.right=null,this.parent=r},a=function(){function t(){n(this,t),this._root=null,this.size=0}return r(t,[{key:"_insert",value:function(t,e,i,n,r,a){var o=void 0;if(null===n)o=new s(t,e,i,r),null===r?this._root=o:r[a]=o;else{var u=t<n.low||t===n.low&&e<n.high?"left":"right";o=this._insert(t,e,i,n[u],n,u),n.max=Math.max(n.max,o.max)}return o}},{key:"insert",value:function(t,e,i){this._insert(t,e,i,this._root,this._root),this.size++}},{key:"lookup",value:function(t){var e=[],n=this._root;return 2===arguments.length&&(n=arguments[1]),null===n||n.max<t?e:(e.push.apply(e,i(this.lookup(t,n.left))),n.low<=t&&(n.high>=t&&e.push(n.data),e.push.apply(e,i(this.lookup(t,n.right)))),e)}}]),t}();e["default"]=a},function(t,e){"use strict";function i(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function n(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}L.TimelineSliderControl=L.Control.extend({initialize:function(){var t=arguments.length<=0||void 0===arguments[0]?{duration:6e5,showTicks:!0}:arguments[0],e={duration:6e5,enableKeyboardControls:!1,enablePlayback:!0,formatOutput:function(t){return""+(t||"")},showTicks:!0,waitToUpdateMap:!1,position:"bottomleft"};this.timelines=[],L.Util.setOptions(this,e),L.Util.setOptions(this,t),"undefined"!=typeof t.start&&(this.start=t.start),"undefined"!=typeof t.end&&(this.end=t.end)},_getTimes:function(){var t=this,e=[];if(this.timelines.forEach(function(i){var r=i.times.filter(function(e){return e>=t.start&&e<=t.end});e.push.apply(e,n(r))}),e.length){var r=function(){e.sort(function(t,e){return t-e});var t=[e[0]];return e.reduce(function(e,i){return e!==i&&t.push(i),i}),{v:t}}();if("object"===("undefined"==typeof r?"undefined":i(r)))return r.v}return e},_recalculate:function(){var t="undefined"!=typeof this.options.start,e="undefined"!=typeof this.options.end,i=this.options.duration,n=1/0,r=-(1/0),s=1/0;this.timelines.forEach(function(t){t.start<n&&(n=t.start),t.end>r&&(r=t.end),t._minGap<s&&(s=t._minGap)}),t||(this.start=n,this._timeSlider.min=n===1/0?0:n),e||(this.end=r,this._timeSlider.max=r===-(1/0)?0:r),this._stepSize=s;var a=(this.end-this.start)/this._stepSize;a>i&&(this._stepSize=(this.end-this.start)/i),this._stepDuration=Math.max(1,i/a)},_nearestEventTime:function(t){for(var e=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=this._getTimes(),n=!1,r=i[0],s=1;s<i.length;s++){var a=i[s];if(n)return a;if(a>=t){if(-1===e)return r;if(1!==e){var o=Math.abs(t-r),u=Math.abs(t-a);return u>o?r:a}if(a!==t)return a;n=!0}r=a}return r},_createDOM:function(){var t=["leaflet-control-layers","leaflet-control-layers-expanded","leaflet-timeline-control"],e=L.DomUtil.create("div",t.join(" "));if(this.container=e,this.options.enablePlayback){var i=L.DomUtil.create("div","sldr-ctrl-container",e),n=L.DomUtil.create("div","button-container",i);this._makeButtons(n),this.options.enableKeyboardControls&&this._addKeyListeners(),this._makeOutput(i)}this._makeSlider(e),this.options.showTicks&&this._buildDataList(e)},_addKeyListeners:function(){var t=this;this._listener=function(){return t._onKeydown.apply(t,arguments)},document.addEventListener("keydown",this._listener)},_removeKeyListeners:function(){document.removeEventListener("keydown",this._listener)},_buildDataList:function(t){this._datalist=L.DomUtil.create("datalist","",t);var e=Math.floor(1e6*Math.random());this._datalist.id="timeline-datalist-"+e,this._timeSlider.setAttribute("list",this._datalist.id),this._rebuildDataList()},_rebuildDataList:function(){for(var t=this._datalist;t.firstChild;)t.removeChild(t.firstChild);var e=L.DomUtil.create("select","",this._datalist);this._getTimes().forEach(function(t){L.DomUtil.create("option","",e).value=t})},_makeButton:function(t,e){var i=this,n=L.DomUtil.create("button",e,t);n.addEventListener("click",function(){return i[e]()}),L.DomEvent.disableClickPropagation(n)},_makeButtons:function(t){this._makeButton(t,"prev"),this._makeButton(t,"play"),this._makeButton(t,"pause"),this._makeButton(t,"next")},_makeSlider:function(t){var e=this,i=L.DomUtil.create("input","time-slider",t);i.type="range",i.min=this.start||0,i.max=this.end||0,i.value=this.start||0,i.addEventListener("input change",function(){return e._sliderChanged()}),i.addEventListener("mousedown",function(){return e.map.dragging.disable()}),document.addEventListener("mouseup",function(){return e.map.dragging.enable()}),this._timeSlider=i},_makeOutput:function(t){this._output=L.DomUtil.create("output","time-text",t),this._output.innerHTML=this.options.formatOutput(this.start)},_onKeydown:function(t){switch(t.keyCode||t.which){case 37:this.prev();break;case 39:this.next();break;case 32:this.toggle();break;default:return}t.preventDefault()},_sliderChanged:function(t){var e=parseFloat(t.target.value,10);this.time=e,this.options.waitToUpdateMap&&"change"!==t.type||this.timelines.forEach(function(t){return t.setTime(e)}),this._output&&(this._output.innerHTML=this.options.formatOutput(e))},addTimelines:function(){var t=this;this.pause();for(var e=this.timelines.length,i=arguments.length,n=Array(i),r=0;i>r;r++)n[r]=arguments[r];n.forEach(function(e){-1===t.timelines.indexOf(e)&&t.timelines.push(e)}),this.timelines.length!==e&&(this._recalculate(),this.options.showTicks&&this._rebuildDataList(),this.setTime(this.start))},removeTimelines:function(){var t=this;this.pause();for(var e=this.timelines.length,i=arguments.length,n=Array(i),r=0;i>r;r++)n[r]=arguments[r];n.forEach(function(e){var i=t.timelines.indexOf(e);-1!==i&&t.timelines.splice(i,1)}),this.timelines.length!==e&&(this._recalculate(),this.options.showTicks&&this._rebuildDataList(),this.setTime(this.start))},toggle:function(){this._playing?this.pause():this.play()},prev:function(){this.pause();var t=this._nearestEventTime(this.time,-1);this._timeSlider.value=t,this.setTime(t)},pause:function(){clearTimeout(this._timer),this._playing=!1,this.container.classList.remove("playing")},play:function(){var t=this;clearTimeout(this._timer),parseFloat(this._timeSlider.value,10)===this.end&&(this._timeSlider.value=this.start),this._timeSlider.value=parseFloat(this._timeSlider.value,10)+this._stepSize,this.setTime(this._timeSlider.value),parseFloat(this._timeSlider.value,10)===this.end?(this._playing=!1,this.container.classList.remove("playing")):(this._playing=!0,this.container.classList.add("playing"),this._timer=setTimeout(function(){return t.play()},this._stepDuration))},next:function(){this.pause();var t=this._nearestEventTime(this.time,1);this._timeSlider.value=t,this.setTime(t)},setTime:function(t){this._sliderChanged({type:"change",target:{value:t}})},onAdd:function(t){return this.map=t,this._createDOM(),this.setTime(this.start),this.container},onRemove:function(){this.options.enableKeyboardControls&&this._removeKeyListeners()}}),L.timelineSliderControl=function(t,e,i,n){return new L.TimelineSliderControl(t,e,i,n)}},function(t,e){}]);